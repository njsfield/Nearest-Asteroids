function Graphmaker(e,t){this.date=this.getFormattedDate(t),this.url=e,this.rawdata}Graphmaker.prototype.getFormattedDate=function(e,t){t=t||"yyyy-mm-dd",e=e?new Date(e):new Date;var r=e,n=r.getDate(),a=r.getMonth()+1,o=r.getFullYear();return n<10&&(n="0"+n),a<10&&(a="0"+a),t.replace(/yyyy/,o).replace(/dd/,n).replace(/mm/,a)},Graphmaker.prototype.getRawDataAsync=function(e,t,r){var n=this;if(e){var a=new XMLHttpRequest;a.addEventListener("load",function(e){n.rawdata=e.target.responseText,r(null,n.rawdata)}),a.addEventListener("error",function(e){r("Error retrieving data:"+e,void 0)}),a.open(t.method,e,!0),a.send()}},Graphmaker.prototype.accessNestedData=function(e,t,r){var n=this,a=null;if(Array.isArray(e))for(var o=0;o<e.length&&!(a=n.accessNestedData(e[o],t,r));o++);else for(var i in e)if(i==t){if(!r)return e[t];if("object"!=typeof e[t])return e[t];if(a=n.accessNestedData(e[i],t,r))break}else if("object"==typeof e[i]&&(a=n.accessNestedData(e[i],t,r)))break;return a},Graphmaker.prototype.buildArrayFrom=function(e,t,r){for(var n=this,a=[],o=0;o<e.length;o++){var i={};for(var s in t)if(i[s]=n.accessNestedData(e[o],t[s],r),!i[s])return"Cannot find property "+t[s]+" in "+e[o];a.push(i)}return a},Graphmaker.prototype.sortBy=function(e,t,r){if(void 0==e[0][t])return"Cannot find property "+t;var n=e.sort(function(e,r){var n="number"==typeof e[t]?e[t]:e[t].toLowerCase(),a="number"==typeof r[t]?r[t]:e[t].toLowerCase();return n<a});return"high-to-low"==r?n:n.reverse()},Graphmaker.prototype.scale=function(e,t,r){var n=this;smallest=this.sortBy(Object.create(e),t)[0][t],largest=this.sortBy(Object.create(e),t)[e.length-1][t],r||(r=[0,100]);var a=r[0],o=r[1];if("number"!=typeof a||"number"!=typeof o)return"Cannot understand scale parameters: "+r;var i=function(e){return e=(e-smallest)/(largest-smallest),e*=o-a,e+=a};return n.nestedReplaceWith(e,t,i)},Graphmaker.prototype.nestedReplaceWith=function(e,t,r){e=Array.isArray(e)?e:[].concat(e);for(var n=[],a=0;a<e.length;a++){var o=e[a];e[a][t]=r instanceof Function?r(e[a][t]):r,n.push(o)}return n},Graphmaker.prototype.formatNumTo=function(e,t,r){r=r||"",e=parseFloat(e),e=t>=0?e.toFixed(t+1).slice(0,-1):e.toString();var n=e.split(".");return n[0]=n[0].replace(/./g,function(e,t,r){return 0!==t&&(r.length-t)%3===0?","+e:e}),n=n[1]?n.join("."):n[0],n+r},Graphmaker.prototype.buildDomElementFrom=function(e,t,r){var n=document.createElement(e);if(1==arguments.length)return n||"Unable to build a "+e+"element";if(2==arguments.length&&"string"==typeof arguments[1])return n.textContent=t,n;for(var a in t)n.setAttribute(a,t[a]);return n.innerHTML=r,n},Graphmaker.prototype.generateToggleGraph=function(e,t,r,n){for(var a=this,o=Array.prototype.forEach,i=this.buildDomElementFrom("div"),s=this.buildDomElementFrom("ul"),l=this.buildDomElementFrom("ul"),d=0;d<e.length;d++){var c=a.buildDomElementFrom("span",e[d].name||""),u=a.buildDomElementFrom("li",e[d],c);u.classList.add(r),l.appendChild(u)}for(var p in t){var m=this.buildDomElementFrom("li",t[p]);!function(t){m.addEventListener("click",function(){var r=a.buildArrayFrom(e,function(e){var t={};return t[e]=e,t}(t));r=a.dataToStyles(r,n[t]),o.call(l.children,function(e,n){e.innerHTML="<span>"+e.getAttribute(t)+"</span>",r?e.style.cssText=r[n]:e.removeAttribute("style")})})}(p),s.appendChild(m)}return s.firstChild.click(),i.appendChild(s),i.appendChild(l),i},Graphmaker.prototype.listToToggle=function(e,t,r){t||(t=["<",">"]);var n=e.children;Array.prototype.forEach.call(n,function(e){e.style.display="none"});var a=this.buildDomElementFrom("span",t[0]);a.classList.add("prev");var o=this.buildDomElementFrom("span",t[1]);o.classList.add("next");var i=this.buildDomElementFrom("span",{display:n[0].textContent},n[0].textContent);i.classList.add("display"),e.appendChild(a),e.appendChild(i),e.appendChild(o);var s=0;o.addEventListener("click",function(){s++,s==n.length-3&&(s=0),i.textContent=n[s].textContent,i.setAttribute("display",n[s].textContent),r&&n[s].click()}),a.addEventListener("click",function(){s--,s==-1&&(s=n.length-3),i.textContent=n[s].textContent,i.setAttribute("display",n[s].textContent),r&&n[s].click()})},Graphmaker.prototype.dataToStyles=function(e,t){var r=this,n=Object.keys(e[0]).toString();if(!t)return null;var a,o=function(e){for(var t=[],r=0;r<e;r++)t.push(null);return t}(e.length),i={};for(var s in t){if(a=r.nestedReplaceWith([].concat(e),n,function(e){return parseFloat(e)}),"value"==t[s][0])"%"==t[s][1]?(a=r.scale(a,n),a=r.nestedReplaceWith(a,n,function(e){return e+"%"})):(a=r.scale(a,n,[5,10]),a=r.nestedReplaceWith(a,n,function(e){return e+t[s][1]}));else if("order"==t[s][0]){a=[];for(var l=0;l<e.length;l++)a.push(function(e,t){var r={};return r[e]=t,r}(n,l));a=r.scale(a,n),a=r.nestedReplaceWith(a,n,function(e){return e+"%"})}i[s]=a.map(function(e){return e[Object.keys(e).toString()]})}var d=o.map(function(e,t,r){var n={},a="";for(var o in i)n[o]=i[o][t];for(var s in n)a+=s,a+=": ",a+=n[s],a+="; ";return a});return d};var g=new Graphmaker;g.url="https://api.nasa.gov/neo/rest/v1/feed?start_date="+g.date+"&api_key=3NW9wqg2QvSWpj4WAFj3tTQYTK85Hj1UEqKsoRo4",g.getRawDataAsync(g.url,{method:"GET"},function(){function e(e,t){e.classList.contains(t)?e.classList.remove(t):e.classList.add(t)}var t=JSON.parse(g.rawdata),r=g.date;g.ASTEROIDS=g.accessNestedData(t,r);var n=g.buildArrayFrom(g.ASTEROIDS,{name:"name",size:"estimated_diameter_min",speed:"kilometers_per_second",missedby:"kilometers"},!0);n=g.nestedReplaceWith(n,"size",function(e){return g.formatNumTo(e,2,"km")}),n=g.nestedReplaceWith(n,"speed",function(e){return g.formatNumTo(e,2,"km/s")}),n=g.nestedReplaceWith(n,"missedby",function(e){return g.formatNumTo(e,2,"km")});var a={name:"Name",size:"Size",speed:"Speed",missedby:"Miss Distance"},o={size:{left:["value","%"],top:["order","%"],width:["value","em"],height:["value","em"]},speed:{left:["value","%"],top:["order","%"]},missedby:{left:["value","%"],top:["order","%"]},name:{left:["order","%"]}},i=g.generateToggleGraph(n,a,"graph__point",o);g.listToToggle(i.firstChild,["<",">"],!0),i.classList.add("graph"),i.firstElementChild.classList.add("graph__nav"),i.lastElementChild.classList.add("graph__display");var s=document.querySelector(".graph");s.parentElement.replaceChild(i,s);var l=document.querySelector(".info"),d=document.querySelector(".info__close"),c=document.querySelector(".info-icon"),u=document.querySelector(".footer-box__date");d.addEventListener("click",e.bind(null,l,"info--hidden")),c.addEventListener("click",e.bind(null,l,"info--hidden")),u.textContent=g.date});